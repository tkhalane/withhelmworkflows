{"payload":{"allShortcutsEnabled":false,"fileTree":{".github/workflows":{"items":[{"name":"azure-kubernetes-service-helm.yml","path":".github/workflows/azure-kubernetes-service-helm.yml","contentType":"file"},{"name":"create-cluster.yml","path":".github/workflows/create-cluster.yml","contentType":"file"},{"name":"create_repo.yml","path":".github/workflows/create_repo.yml","contentType":"file"},{"name":"deploy.yml","path":".github/workflows/deploy.yml","contentType":"file"},{"name":"scaffold-golang-v1.yml","path":".github/workflows/scaffold-golang-v1.yml","contentType":"file"},{"name":"scaffold-golang.yml","path":".github/workflows/scaffold-golang.yml","contentType":"file"},{"name":"scaling.yml","path":".github/workflows/scaling.yml","contentType":"file"}],"totalCount":7},".github":{"items":[{"name":"workflows","path":".github/workflows","contentType":"directory"}],"totalCount":1},"":{"items":[{"name":".github","path":".github","contentType":"directory"},{"name":"helm","path":"helm","contentType":"directory"},{"name":"platform","path":"platform","contentType":"directory"},{"name":"src","path":"src","contentType":"directory"},{"name":"terraform","path":"terraform","contentType":"directory"},{"name":"Dockerfile","path":"Dockerfile","contentType":"file"},{"name":"mvnw","path":"mvnw","contentType":"file"},{"name":"mvnw.cmd","path":"mvnw.cmd","contentType":"file"},{"name":"pom.xml","path":"pom.xml","contentType":"file"},{"name":"port.yml","path":"port.yml","contentType":"file"}],"totalCount":10}},"fileTreeProcessingTime":7.297319,"foldersToFetch":[],"reducedMotionEnabled":null,"repo":{"id":666397086,"defaultBranch":"main","name":"mtnx-demo","ownerLogin":"tkhalane","currentUserCanPush":false,"isFork":false,"isEmpty":false,"createdAt":"2023-07-14T12:13:35.000Z","ownerAvatar":"https://avatars.githubusercontent.com/u/1014541?v=4","public":true,"private":false,"isOrgOwned":false},"refInfo":{"name":"main","listCacheKey":"v0:1690327713.0","canEdit":false,"refType":"branch","currentOid":"cc1f509ac3a309cec0eff6ad83018c8b3252b184"},"path":".github/workflows/deploy.yml","currentUser":null,"blob":{"rawLines":["name: CI","on:","  workflow_dispatch:","    inputs:","      service:","        required: true","        description: \"Service name to deploy\"","        type: string","      environment:","        required: true","        default: staging","        description: \"Environment to deploy service to\"","        type: string","      port_payload:","        required: true","        description: \"Port's payload, including details for who triggered the action and general context (blueprint, run id, etc...)\"","        type: string","","env:","  # Use docker.io for Docker Hub if empty","  REGISTRY: docker.io","  # github.repository as <account>/<repo>","  IMAGE_NAME: ${{ github.repository }}","","jobs:","  push_to_registry:","    name: Push Docker image to Docker Hub","    runs-on: ubuntu-latest","    steps:","      - uses: actions/checkout@v3","      - name: Check out the repo","        run: docker build . --file Dockerfile --tag ${{ env.IMAGE_NAME }}:${{ github.sha }}","","      - name: Set up Docker Buildx","        uses: docker/setup-buildx-action@v2","","      - name: Log in to Docker Hub","        uses: docker/login-action@v2","        with:","          username: ${{ secrets.DOCKER_USERNAME }}","          password: ${{ secrets.DOCKER_PASSWORD }}","","      - name: Extract metadata (tags, labels) for Docker","        id: meta","        uses: docker/metadata-action@v2","        with:","          images: ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}","","      - name: Build and push Docker image","        uses: docker/build-push-action@v2","        with:","          context: \"{{defaultContext}}\"","          push: true","          tags: ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}:${{ github.sha }}","          labels: ${{ steps.meta.outputs.labels }}","","      - name: Update Image Version in the related HelmChart values.yaml","        uses: fjogeleit/yaml-update-action@main","        with:","          valueFile: \"helm/values.yaml\"","          propertyPath: \"image.tag\"","          value: \"${{ github.sha }}\"","          branch: main","          targetBranch: main","          createPR: false","          message: \"Update Image Version to ${{ github.sha }}\"","","  report-deployment:","    name: Report new deployment Entity","    runs-on: ubuntu-latest","    steps:","      - name: Extract SHA short","        run: echo \"SHA_SHORT=${GITHUB_SHA:0:7}\" >> $GITHUB_ENV","      - name: \"Report deployment Entity to port ðŸš¢\"","        uses: port-labs/port-github-action@v1","        with:","          clientId: ${{ secrets.PORT_CLIENT_ID }}","          clientSecret: ${{ secrets.PORT_CLIENT_SECRET }}","          identifier: ${{ inputs.service }}-${{ inputs.environment }}-${{ env.SHA_SHORT }}","          blueprint: deployment","          properties: |","            {","               \"jobUrl\": \"${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\",","               \"deployingUser\": \"${{ github.actor }}\",","               \"imageTag\": \"latest\",","               \"commitSha\": \"${{ env.SHA_SHORT }}\"","            }","          runId: \"${{fromJson(inputs.port_payload).context.runId}}\""],"stylingDirectives":[[{"start":0,"end":4,"cssClass":"pl-ent"},{"start":6,"end":8,"cssClass":"pl-s"}],[{"start":0,"end":2,"cssClass":"pl-ent"}],[{"start":2,"end":19,"cssClass":"pl-ent"}],[{"start":4,"end":10,"cssClass":"pl-ent"}],[{"start":6,"end":13,"cssClass":"pl-ent"}],[{"start":8,"end":16,"cssClass":"pl-ent"},{"start":18,"end":22,"cssClass":"pl-c1"}],[{"start":8,"end":19,"cssClass":"pl-ent"},{"start":21,"end":45,"cssClass":"pl-s"},{"start":21,"end":22,"cssClass":"pl-pds"},{"start":44,"end":45,"cssClass":"pl-pds"}],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":20,"cssClass":"pl-s"}],[{"start":6,"end":17,"cssClass":"pl-ent"}],[{"start":8,"end":16,"cssClass":"pl-ent"},{"start":18,"end":22,"cssClass":"pl-c1"}],[{"start":8,"end":15,"cssClass":"pl-ent"},{"start":17,"end":24,"cssClass":"pl-s"}],[{"start":8,"end":19,"cssClass":"pl-ent"},{"start":21,"end":55,"cssClass":"pl-s"},{"start":21,"end":22,"cssClass":"pl-pds"},{"start":54,"end":55,"cssClass":"pl-pds"}],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":20,"cssClass":"pl-s"}],[{"start":6,"end":18,"cssClass":"pl-ent"}],[{"start":8,"end":16,"cssClass":"pl-ent"},{"start":18,"end":22,"cssClass":"pl-c1"}],[{"start":8,"end":19,"cssClass":"pl-ent"},{"start":21,"end":133,"cssClass":"pl-s"},{"start":21,"end":22,"cssClass":"pl-pds"},{"start":132,"end":133,"cssClass":"pl-pds"}],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":20,"cssClass":"pl-s"}],[],[{"start":0,"end":3,"cssClass":"pl-ent"}],[{"start":2,"end":41,"cssClass":"pl-c"},{"start":2,"end":3,"cssClass":"pl-c"}],[{"start":2,"end":10,"cssClass":"pl-ent"},{"start":12,"end":21,"cssClass":"pl-s"}],[{"start":2,"end":41,"cssClass":"pl-c"},{"start":2,"end":3,"cssClass":"pl-c"}],[{"start":2,"end":12,"cssClass":"pl-ent"},{"start":14,"end":38,"cssClass":"pl-s"}],[],[{"start":0,"end":4,"cssClass":"pl-ent"}],[{"start":2,"end":18,"cssClass":"pl-ent"}],[{"start":4,"end":8,"cssClass":"pl-ent"},{"start":10,"end":41,"cssClass":"pl-s"}],[{"start":4,"end":11,"cssClass":"pl-ent"},{"start":13,"end":26,"cssClass":"pl-s"}],[{"start":4,"end":9,"cssClass":"pl-ent"}],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":33,"cssClass":"pl-s"}],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":32,"cssClass":"pl-s"}],[{"start":8,"end":11,"cssClass":"pl-ent"},{"start":13,"end":91,"cssClass":"pl-s"}],[],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":34,"cssClass":"pl-s"}],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":43,"cssClass":"pl-s"}],[],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":34,"cssClass":"pl-s"}],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":36,"cssClass":"pl-s"}],[{"start":8,"end":12,"cssClass":"pl-ent"}],[{"start":10,"end":18,"cssClass":"pl-ent"},{"start":20,"end":50,"cssClass":"pl-s"}],[{"start":10,"end":18,"cssClass":"pl-ent"},{"start":20,"end":50,"cssClass":"pl-s"}],[],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":56,"cssClass":"pl-s"}],[{"start":8,"end":10,"cssClass":"pl-ent"},{"start":12,"end":16,"cssClass":"pl-s"}],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":39,"cssClass":"pl-s"}],[{"start":8,"end":12,"cssClass":"pl-ent"}],[{"start":10,"end":16,"cssClass":"pl-ent"},{"start":18,"end":59,"cssClass":"pl-s"}],[],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":41,"cssClass":"pl-s"}],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":41,"cssClass":"pl-s"}],[{"start":8,"end":12,"cssClass":"pl-ent"}],[{"start":10,"end":17,"cssClass":"pl-ent"},{"start":19,"end":39,"cssClass":"pl-s"},{"start":19,"end":20,"cssClass":"pl-pds"},{"start":38,"end":39,"cssClass":"pl-pds"}],[{"start":10,"end":14,"cssClass":"pl-ent"},{"start":16,"end":20,"cssClass":"pl-c1"}],[{"start":10,"end":14,"cssClass":"pl-ent"},{"start":16,"end":75,"cssClass":"pl-s"}],[{"start":10,"end":16,"cssClass":"pl-ent"},{"start":18,"end":50,"cssClass":"pl-s"}],[],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":71,"cssClass":"pl-s"}],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":47,"cssClass":"pl-s"}],[{"start":8,"end":12,"cssClass":"pl-ent"}],[{"start":10,"end":19,"cssClass":"pl-ent"},{"start":21,"end":39,"cssClass":"pl-s"},{"start":21,"end":22,"cssClass":"pl-pds"},{"start":38,"end":39,"cssClass":"pl-pds"}],[{"start":10,"end":22,"cssClass":"pl-ent"},{"start":24,"end":35,"cssClass":"pl-s"},{"start":24,"end":25,"cssClass":"pl-pds"},{"start":34,"end":35,"cssClass":"pl-pds"}],[{"start":10,"end":15,"cssClass":"pl-ent"},{"start":17,"end":36,"cssClass":"pl-s"},{"start":17,"end":18,"cssClass":"pl-pds"},{"start":35,"end":36,"cssClass":"pl-pds"}],[{"start":10,"end":16,"cssClass":"pl-ent"},{"start":18,"end":22,"cssClass":"pl-s"}],[{"start":10,"end":22,"cssClass":"pl-ent"},{"start":24,"end":28,"cssClass":"pl-s"}],[{"start":10,"end":18,"cssClass":"pl-ent"},{"start":20,"end":25,"cssClass":"pl-c1"}],[{"start":10,"end":17,"cssClass":"pl-ent"},{"start":19,"end":62,"cssClass":"pl-s"},{"start":19,"end":20,"cssClass":"pl-pds"},{"start":61,"end":62,"cssClass":"pl-pds"}],[],[{"start":2,"end":19,"cssClass":"pl-ent"}],[{"start":4,"end":8,"cssClass":"pl-ent"},{"start":10,"end":38,"cssClass":"pl-s"}],[{"start":4,"end":11,"cssClass":"pl-ent"},{"start":13,"end":26,"cssClass":"pl-s"}],[{"start":4,"end":9,"cssClass":"pl-ent"}],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":31,"cssClass":"pl-s"}],[{"start":8,"end":11,"cssClass":"pl-ent"},{"start":13,"end":62,"cssClass":"pl-s"}],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":51,"cssClass":"pl-s"},{"start":14,"end":15,"cssClass":"pl-pds"},{"start":50,"end":51,"cssClass":"pl-pds"}],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":45,"cssClass":"pl-s"}],[{"start":8,"end":12,"cssClass":"pl-ent"}],[{"start":10,"end":18,"cssClass":"pl-ent"},{"start":20,"end":49,"cssClass":"pl-s"}],[{"start":10,"end":22,"cssClass":"pl-ent"},{"start":24,"end":57,"cssClass":"pl-s"}],[{"start":10,"end":20,"cssClass":"pl-ent"},{"start":22,"end":90,"cssClass":"pl-s"}],[{"start":10,"end":19,"cssClass":"pl-ent"},{"start":21,"end":31,"cssClass":"pl-s"}],[{"start":10,"end":20,"cssClass":"pl-ent"},{"start":22,"end":23,"cssClass":"pl-s"}],[{"start":0,"end":13,"cssClass":"pl-s"}],[{"start":0,"end":111,"cssClass":"pl-s"}],[{"start":0,"end":54,"cssClass":"pl-s"}],[{"start":0,"end":36,"cssClass":"pl-s"}],[{"start":0,"end":50,"cssClass":"pl-s"}],[{"start":0,"end":13,"cssClass":"pl-s"}],[{"start":0,"end":0,"cssClass":"pl-s"},{"start":10,"end":15,"cssClass":"pl-ent"},{"start":17,"end":67,"cssClass":"pl-s"},{"start":17,"end":18,"cssClass":"pl-pds"},{"start":66,"end":67,"cssClass":"pl-pds"}]],"csv":null,"csvError":null,"dependabotInfo":{"showConfigurationBanner":false,"configFilePath":null,"networkDependabotPath":"/tkhalane/mtnx-demo/network/updates","dismissConfigurationNoticePath":"/settings/dismiss-notice/dependabot_configuration_notice","configurationNoticeDismissed":null,"repoAlertsPath":"/tkhalane/mtnx-demo/security/dependabot","repoSecurityAndAnalysisPath":"/tkhalane/mtnx-demo/settings/security_analysis","repoOwnerIsOrg":false,"currentUserCanAdminRepo":false},"displayName":"deploy.yml","displayUrl":"https://github.com/tkhalane/mtnx-demo/blob/main/.github/workflows/deploy.yml?raw=true","headerInfo":{"blobSize":"2.89 KB","deleteInfo":{"deletePath":null,"deleteTooltip":"You must be signed in to make or propose changes"},"editInfo":{"editTooltip":"You must be signed in to make or propose changes"},"ghDesktopPath":"https://desktop.github.com","gitLfsPath":null,"onBranch":true,"shortPath":"8e7f4b4","siteNavLoginPath":"/login?return_to=https%3A%2F%2Fgithub.com%2Ftkhalane%2Fmtnx-demo%2Fblob%2Fmain%2F.github%2Fworkflows%2Fdeploy.yml","isCSV":false,"isRichtext":false,"toc":null,"lineInfo":{"truncatedLoc":"88","truncatedSloc":"80"},"mode":"file"},"image":false,"isCodeownersFile":null,"isValidLegacyIssueTemplate":false,"issueTemplateHelpUrl":"https://docs.github.com/articles/about-issue-and-pull-request-templates","issueTemplate":null,"discussionTemplate":null,"language":"YAML","large":false,"loggedIn":false,"newDiscussionPath":"/tkhalane/mtnx-demo/discussions/new","newIssuePath":"/tkhalane/mtnx-demo/issues/new","planSupportInfo":{"repoIsFork":null,"repoOwnedByCurrentUser":null,"requestFullPath":"/tkhalane/mtnx-demo/blob/main/.github/workflows/deploy.yml","showFreeOrgGatedFeatureMessage":null,"showPlanSupportBanner":null,"upgradeDataAttributes":null,"upgradePath":null},"publishBannersInfo":{"dismissActionNoticePath":"/settings/dismiss-notice/publish_action_from_dockerfile","dismissStackNoticePath":"/settings/dismiss-notice/publish_stack_from_file","releasePath":"/tkhalane/mtnx-demo/releases/new?marketplace=true","showPublishActionBanner":false,"showPublishStackBanner":false},"renderImageOrRaw":false,"richText":null,"renderedFileInfo":null,"tabSize":8,"topBannersInfo":{"overridingGlobalFundingFile":false,"globalPreferredFundingPath":null,"repoOwner":"tkhalane","repoName":"mtnx-demo","showInvalidCitationWarning":false,"citationHelpUrl":"https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/creating-a-repository-on-github/about-citation-files","showDependabotConfigurationBanner":false,"actionsOnboardingTip":null},"truncated":false,"viewable":true,"workflowRedirectUrl":"/tkhalane/mtnx-demo/actions/workflows/deploy.yml","symbols":{"timedOut":false,"notAnalyzed":true,"symbols":[]}},"copilotUserAccess":null,"csrf_tokens":{"/tkhalane/mtnx-demo/branches":{"post":"gzuCex-mKRUEGIejnwzJSG2kgxoD63nNx7JA491eHVf6AcHU8eNSHAXd4CFEqtLOoFSIdqzA03ecuINfAKLuQQ"}}},"title":"mtnx-demo/.github/workflows/deploy.yml at main Â· tkhalane/mtnx-demo","locale":"en"}